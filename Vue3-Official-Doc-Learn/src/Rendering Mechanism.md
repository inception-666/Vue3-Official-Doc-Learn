### 虛擬 DOM (Virtual DOM，簡稱 VDOM) 
是一種編程概念，意為將目標所需的 UI 通過數據結構"虛擬"地表示出來，保存在內存中，然後將真實的 DOM 與之保持同步。概念由 [React](https://reactjs.org/) 率先開拓，隨後被許多不同的框架採用包括 Vue。

沒有標準的實現方式，可以認為是一種模式。

運行時渲染器可以遍歷虛擬 DOM 樹，並從中生成對應的真實 DOM 樹 ，這個過程被稱為掛載 (mount)。

如果我們有兩份虛擬 DOM 樹，渲染器將會有比較地遍歷它們，找出它們之間的區別，並應用這其中的變化到真實的 DOM 上。這個過程被稱為更新 (patch)，又被稱為“比對”(diffing) 或“協調”(reconciliation)。

虛擬 DOM 帶來的主要收益是它讓開發者能夠靈活、聲明式地創建、檢查和組合所需 UI 的結構，同時只需把具體的 DOM 操作留給渲染器去處理。

### Render Pipeline渲染管線
Vue 組件掛載時會發生如下幾件事:  
1. `Compile編譯：Vue 模板 被編譯為渲染函數`：返回(回傳)虛擬 DOM 樹的函數。
這步驟可通過 構建步驟提前完成，也可以通過使用運行時編譯器即時完成。
2. `Mount掛載`：運行時渲染器調用渲染函數，遍歷返回的虛擬 DOM 樹，並基於它VDOM`創建實際的 DOM 節點`。這一步會作為(前面說的內容將會實現於)`響應式的副作用`執行，因此它會追蹤其中所用到的所有響應式依賴。
3. `Patch更新`：當一個依賴發生變化後，`副作用會重新運行`，這時候會創建一個更新後的虛擬 DOM 樹。運行時渲染器遍歷這棵新樹，將它與舊樹進行比較，然後將必要的更新應用到真實 DOM 上去。

![](https://zh-hk.vuejs.org/assets/render-pipeline.CwxnH_lZ.png)

### 模板 vs. 渲染函數
Vue 也提供了 API 使我們可以使用直接手寫渲染函數。`在處理高度動態的邏輯(否則一般不使用)時`，渲染函數相比於模板更加靈活，因為可以完全地使用 JavaScript 來構造你想要的 vnode。  
但預設下推薦使用模板因為下述原因:
1. 模板更貼近實際的 HTML。能更方便重用已有的 HTML 更好的可訪問性體驗、方便地使用 CSS ，且更易使設計師理解和修改。  
2. 由於其確定的語法，更容易對模板做靜態分析。這使得 Vue 的模板編譯器能夠應用許多編譯時優化來提升虛擬 DOM 的性能表現。
